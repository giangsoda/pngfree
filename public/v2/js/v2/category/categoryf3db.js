$(function(){try{getInjectData()}catch(e){}$(document).click(function(){$(".comment-search-dropdown-wrap").hide()}),$(".comment-search-keyword-box-input").on("focus",function(){var e=$(this).parents(".serach-box").find(".search-type a.on").data("type"),t=$.trim($(this).val());$.getJSON("/api/index/get-keywords",{type:e,keyword:t},function(e){200==e.status&&""!=e.data&&($(".comment-search-dropdown-wrap").children(".search-dropdown").html(e.data),$(".comment-search-dropdown-wrap").show())})}),$(".comment-search-keyword-box-input").on("keyup",function(){var e=$.trim($(this).val()),t=$(this).parents(".serach-box").find(".search-type a.on").data("type"),a=1;switch(t){case 1:a="Element";break;case 2:a="Back";break;case 5:a="Template";break;case 6:a="PPT";break;case 7:a="Font"}Pngtree.BaseFun.Ga_Deploy("Category_Page","Search_Bar",a),$.getJSON("/api/index/get-keywords",{type:t,keyword:e},function(e){200==e.status&&""!=e.data?($(".comment-search-dropdown-wrap").children(".search-dropdown").html(e.data),$(".comment-search-dropdown-wrap").show()):$(".comment-search-dropdown-wrap").hide()})}),$(".search-dropdown").on("click",".recent-search span",function(){$(this).css("cursor","pointer");var e=$(this).attr("data-val"),t=parseInt($(this).parents(".serach-box").find(".search-type a.on").data("type"));Pngtree.BaseFun.SearchClick(t,e)}),$(".search-dropdown").on("click","p",function(){var e=$(this).attr("data-val"),t=parseInt($(this).parents(".serach-box").find(".search-type a.on").data("type"));Pngtree.BaseFun.SearchClick(t,e)}),$(".search-box-input-index").on("click",function(){var e=$(this).parents(".serach-box").find(".search-type a.on").data("type"),t=$.trim($(this).siblings(".comment-search-keyword-box-input").val()),a="Element_Category_Page";switch($(this).data("ga")){case 1:a="Element_Category_Page";break;case 2:a="Back_Category_Page";break;case 5:a="Template_Category_Page";break;case 6:a="PPT_Category_Page";break;case 3:a="Icons_Category_Page";break;default:a="Element_Category_Page"}var n="Element";switch(e){case 1:n="Element";break;case 2:n="Back";break;case 5:n="Template";break;case 6:n="PPT";break;case 7:n="Font"}Pngtree.BaseFun.Ga_Deploy(a,"Search",n),Pngtree.BaseFun.SearchClick(e,t)}),$(".comment-search-keyword-box-input").on("keydown",function(e){if(13==e.keyCode)return $(this).siblings(".search-box-input-index").trigger("click"),!1});var t,a,e=$(".masonry-element");if(void 0!==e&&1<=e.length){function n(e){var t;function a(e){parseInt(e.height());var t=e.closest(".card-img");if(1==t.find("img").size())parseInt(t.height())}1680<e?t=1:1248<=e&&e<=1680?t=.76:e<1248&&(t=.68),$(".masonry-element .li-box img").each(function(){var e=parseInt($(this).attr("data-height"));$(this).attr("height",e*t)}),this.complete?a($(this)):$(this).load(function(){a($(this))})}t=$(window).width(),a=!1,$(".masonry-element .li-box img").each(function(){var e=parseInt($(this).attr("height"));$(this).attr("data-height",e)}),n(t),$(window).resize(function(){var e=$(window).width();1680<t&&e<1680||1248<=t&&t<=1680&&1680<e||1248<=t&&t<=1680&&e<1248||t<1248&&1248<e?(t=e,a=!0):a=!1,a&&(n(t),setTimeout(function(){$(".masonry-element").masonry({itemSelector:".li-box",gutter:".gutter-sizer"})},280))}),e.masonry({itemSelector:".li-box",singleMode:!0,isAnimated:!0,resizeable:!0,gutter:".gutter-sizer"})}var r=$("#flexBox-images");function o(n,e,r){r=r||0;if(!$(n)[0])return!1;try{var o,s,i=$(n).offset().top,c=$(e).offset().top}catch(e){}function t(){o=$(n).innerHeight(),s=$(e).innerHeight()}function a(){if(s<o+r)console.log("too little");else{var e,t,a=$(window).scrollTop()-i+40+60;e=n,t=i,$(window).scrollTop()+60>=t&&!$(e).hasClass("scroll")?$(e).addClass("scroll"):$(window).scrollTop()+60<=t&&$(e).hasClass("scroll")&&$(e).removeClass("scroll"),$(window).scrollTop()+o+60+r>=c+s&&(a=c+s-o-i+40-r),$(window).scrollTop()+60>=i&&$(n).css("top",a)}}t(),$(window).on("scroll",a),$(window).on("resize",function(){t(),a()})}void 0!==r&&1<=r.length&&(console.log(1),setTimeout(function(){r.flexImages({rowHeight:280,container:".bnPic-list",truncate:!0})},500)),$(".del-data").on("click",function(){var e=$(this).data("id"),t=$(this).data("type");if(!confirm("Did you confirm the deletion?"))return!1;$.getJSON("/api/message/so-delete",{id:e,type:t},function(e){console.log(e),200==e.status?(alert("Delete Success"),window.location.reload()):alert("Delete Failed")})}),o(".popularalbums-rank-inner",".popularalbums-list",0),o(".hotart-list-router",".hotart-list-inner",248),"#tar"===location.hash&&$(window).scrollTop(456),$(".premium-setting-list").on("click",".cancel-agreement",function(){var e=$(this).data("ag");void 0!==e&&""!=e&&$("#premium-setting").show().find(".go-cancel").prop("href","/pay/cancel-agreement?ag="+e)}),$("#premium-setting").on("click",".stop-cancel,.cls-btn",function(){$("#premium-setting").hide()}),$(".premium-setting-sf").on("click",".cls-btn,.cancel-return",function(){window.location.href="/user/plan"}),$(".main-cate").on("click",function(){var e=$(this).data("name");ga("pngtree.send","event","template_cate","main_cate",e)}),$(".father-cate").on("click",function(){var e=$(this).data("name");ga("pngtree.send","event","template_cate","child_cate",e)}),$(".style-cate").on("click",function(){var e=$(this).data("name");ga("pngtree.send","event","template_cate","style_cate",e)}),Pngtree.BaseFun.Ga_Deploy_Href(".element-cate-click a","Element_Category_Page","Cate"),Pngtree.BaseFun.Ga_Deploy_Href(".SM-lists a","User","Cate"),Pngtree.BaseFun.Ga_Deploy_Href(".back-cate-click a","Back_Category_Page","Cate"),Pngtree.BaseFun.Ga_Deploy_Href(".ppt-cate-click a","PPT_Category_Page","Cate"),Pngtree.BaseFun.Ga_Deploy_Href(".user-click a","User","Cate"),Pngtree.BaseFun.Ga_Deploy_Href(".hotart-list-router a,hotart-state-router a","Font_Category_Page","Cate"),Pngtree.BaseFun.Ga_Deploy_Class(".main-cate,.father-cate,.style-cate","Template_Category_Page","Cate","name"),Pngtree.BaseFun.Ga_Deploy_Class(".element-list-click","Element_Category_Page","List","ga"),Pngtree.BaseFun.Ga_Deploy_Class(".back-list-click","Back_Category_Page","List","ga"),Pngtree.BaseFun.Ga_Deploy_Class(".ppt-list-click","PPT_Category_Page","List","ga"),Pngtree.BaseFun.Ga_Deploy_Class(".tem-list-click","Template_Category_Page","List","ga"),Pngtree.BaseFun.Ga_Deploy_Class(".hotart-item .item-link","Font_Category_Page","List","ga"),Pngtree.BaseFun.Ga_Deploy_Class(".item-btn-group .down-jpg-click","Font_Category_Page","List","ga"),Pngtree.BaseFun.Ga_Deploy_Class(".item-btn-group .down-rar-click","Font_Category_Page","List","ga"),$(".sns-btn").on("click",function(){Pngtree.BaseFun.Ga_Deploy("User","Invite_Your_Friend","click")})});